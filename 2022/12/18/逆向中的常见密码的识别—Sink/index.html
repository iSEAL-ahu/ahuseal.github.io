<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/iSEAL.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/iSEAL.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/iSEAL.png">
  <link rel="mask-icon" href="/images/iSEAL.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"iseal.ac.cn","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="最近半年打了很多比赛，也见了很多的逆向方向的题目。对于解决对比密文类的逆向题，往往绕不开的一个问题就是对于加密算法的识别。下面就分类对于各种加密的特征以及识别方法进行总结。">
<meta property="og:type" content="article">
<meta property="og:title" content="逆向中的常见密码的识别">
<meta property="og:url" content="https://iseal.ac.cn/2022/12/18/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%B8%B8%E8%A7%81%E5%AF%86%E7%A0%81%E7%9A%84%E8%AF%86%E5%88%AB%E2%80%94Sink/index.html">
<meta property="og:site_name" content="iSEAL">
<meta property="og:description" content="最近半年打了很多比赛，也见了很多的逆向方向的题目。对于解决对比密文类的逆向题，往往绕不开的一个问题就是对于加密算法的识别。下面就分类对于各种加密的特征以及识别方法进行总结。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671011360136-0b1e9e27-60b8-4fb4-aca5-0d951d52e493.png#averageHue=%23fdfdfd&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=335&id=u5abe7430&margin=%5Bobject%20Object%5D&name=image.png&originHeight=419&originWidth=374&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13314&status=done&style=none&taskId=ud28bbd74-098d-47aa-891c-72d20712ddf&title=&width=299.2">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671011319775-34bc4bca-38fe-44ff-abe7-bcc30cb4ded5.png#averageHue=%23fdfbfb&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=516&id=u6086d67b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=645&originWidth=1209&originalType=binary&ratio=1&rotation=0&showTitle=false&size=70323&status=done&style=none&taskId=ub91f1539-3ba3-42a4-96d4-0c3f537b996&title=&width=967.2">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671014351638-0cc8d287-923b-4ebe-991a-680e3687b014.png#averageHue=%23f7f6f6&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u668837ea&margin=%5Bobject%20Object%5D&name=image.png&originHeight=372&originWidth=250&originalType=url&ratio=1&rotation=0&showTitle=false&size=31977&status=done&style=none&taskId=u4c6b5b09-20e3-481d-aa8f-4feb351e0f9&title=">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671018126611-9c054cb2-6312-440e-9e9b-30409a85568a.png#averageHue=%23b4c294&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u646da090&margin=%5Bobject%20Object%5D&name=image.png&originHeight=166&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=14498&status=done&style=none&taskId=u18942e56-66b5-4b18-9ae2-ddc0aaee76a&title=">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671018342661-1cc495b5-1625-4446-b261-da2747cd90c4.png#averageHue=%23617981&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=uc4d60e79&margin=%5Bobject%20Object%5D&name=image.png&originHeight=119&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=14625&status=done&style=none&taskId=u4bb9507d-513b-491e-86f1-6f2b2fbc647&title=">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671019352528-4aeba7b2-e443-4eb2-8628-6d388c26d2e9.png#averageHue=%23f3f3f3&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=113&id=dV3M5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=141&originWidth=521&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14907&status=done&style=none&taskId=u6373ff85-1178-45bc-a637-9ddfd9825d8&title=&width=416.8">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/71c1775d91d38ee726cc9b43b4cef34f.svg#card=math&code=GF%282%5E8%29&id=dDA8x">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/2769589f342d265753934522b6464d66.svg#card=math&code=03_%7B16%7Dx%5E3%20%2B%2001_%7B16%7Dx%5E2%20%2B%2001_%7B16%7Dx%20%2B%2002_%7B16%7D&id=yljhf">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/1c4ab5dd901f4f11c5c07f67a5faac2c.svg#card=math&code=x%5E4%20%2B%201&id=O0E4u">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671019070773-9bb9630a-f776-4938-b16f-7b0b07d86689.png#averageHue=%23ebc47e&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u3e8df6bf&margin=%5Bobject%20Object%5D&name=image.png&originHeight=170&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=16376&status=done&style=none&taskId=ueb7e0b33-c0dc-44b3-980b-2f1a7cb5d0d&title=">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671017800841-6832f751-3a51-4a38-ba83-f4036f3f67c9.png#averageHue=%23deba78&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=BlQ2B&margin=%5Bobject%20Object%5D&name=image.png&originHeight=249&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=19903&status=done&style=none&taskId=uc1707850-460a-46b8-9138-55846d8cb51&title=">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671022609474-87726f66-e8d0-4501-b101-e956eb193cb0.png#averageHue=%23bee5ec&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=82&id=u57ca110d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=102&originWidth=397&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9167&status=done&style=none&taskId=u4de42cd9-e80b-4d40-b19b-4577c63c755&title=&width=317.6">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671020937494-d43b18f1-1d86-4392-8f3f-6708a9459a65.png#averageHue=%23000000&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=249&id=WqRA5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=996&originWidth=1024&originalType=url&ratio=1&rotation=0&showTitle=false&size=108289&status=done&style=none&taskId=u88aa3d1a-f648-4df1-a330-401d5959252&title=&width=256">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/17a8d1cc46fd9320944710021f130f78.svg#card=math&code=X_%7Bi%2B4%7D%20%3D%20X_i%20%5Coplus%20T%28X_%7Bi%2B1%7D%20%5Coplus%20X_%7Bi%2B2%7D%20%5Coplus%20X_%7Bi%2B3%7D%20%5Coplus%20rk_i%29&id=FkS8T">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/98be0941ad80cb7d099eda854884bf2f.svg#card=math&code=T%28X%29%20%3D%20L%28%5Ctau%28X%29%29&id=zCEpB">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/dd7d6991b80636e1d04c98e736373978.svg#card=math&code=%5Ctau%28X%29%20%3D%20%28Sbox%28x_0%29%2C%20Sbox%28x_1%29%2CSbox%28x_2%29%2C%20Sbox%28x_3%29%29&id=TwVRt">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/678f151871d83a46f54ebf90d9370c86.svg#card=math&code=L%28X%29%20%3D%20X%20%5Coplus%20%28X%20%3C%3C%3C%202%29%20%5Coplus%20%28X%20%3C%3C%3C%2010%29%20%5Coplus%20%28X%20%3C%3C%3C%2018%29%20%5Coplus%20%28X%20%3C%3C%3C%2024%29&id=yDtAP">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671027149741-16577499-18d4-4023-a95c-b6c413214abb.png#averageHue=%23f9f9f9&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=593&id=u49e4f38b&margin=%5Bobject%20Object%5D&name=SM4.png&originHeight=741&originWidth=602&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33102&status=done&style=none&taskId=u16f3215b-7b70-45d4-a278-9816080939a&title=&width=481.6">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/5b7b1bf1a34efe9e86e4821e5740de9c.svg#card=math&code=MK%20%3D%20%28MK_0%2C%20MK_1%2C%20MK_2%2C%20MK_3%29&id=nJ3K5">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/917e82e80b5360bbf762ce438889e5ba.svg#card=math&code=%28K_0%2C%20K_1%2C%20K_2%2C%20K_3%29%20%3D%20%28MK_0%20%5Coplus%20FK_0%2C%20MK_1%20%5Coplus%20FK_1%2C%20MK_2%20%5Coplus%20FK_2%2CMK_3%20%5Coplus%20FK_3%29&id=FEOVI">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/088fe96dd4ee9f69cbc64cdae91c52b3.svg#card=math&code=K_%7Bi%20%2B%204%7D%20%3D%20K_i%20%5Coplus%20T%27%28K_%7Bi%2B1%7D%20%5Coplus%20K_%7Bi%2B2%7D%5Coplus%20K_%7Bi%2B3%7D%5Coplus%20CK_i%29&id=MJNtJ">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/975e3cea11ce5bf44e5f72890d1e06db.svg#card=math&code=L%27%28X%29%20%3D%20X%20%5Coplus%20%28X%20%3C%3C%3C%2013%29%20%5Coplus%28X%20%3C%3C%3C%2023%29&id=l3qic">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/d4cd21d60552e207f237e82def9029b6.svg#card=math&code=p&id=YFh2k">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/34c7b563b30bde3c748139530686798e.svg#card=math&code=q&id=wXGLc">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/c7b79e4ca306d5cedc5003c18f8218f7.svg#card=math&code=p%20%5Cneq%20q&id=md6ek">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/e61b38e90b092dfc845ef584d5ba51a0.svg#card=math&code=N%20%3D%20p%20%2A%20q&id=vw3j7">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/a0e97b108ba0aa54041fa4c4957e43e3.svg#card=math&code=r%20%3D%20%5Cvarphi%28p%29%20%5Ctimes%20%5Cvarphi%28q%29%20%3D%20%28p%20-%201%29%20%5Ctimes%20%28q%20-%201%29&id=W6HdC">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/72cb3a229067770aeb6caa625a65a1a1.svg#card=math&code=r&id=W9Bj6">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/c9a277d40d3a0b3afb85cdb557908945.svg#card=math&code=e&id=GCGPF">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/c9a277d40d3a0b3afb85cdb557908945.svg#card=math&code=e&id=QSJkT">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/72cb3a229067770aeb6caa625a65a1a1.svg#card=math&code=r&id=ZfeoS">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/56c1b0cb7a48ccf9520b0adb3c8cb2e8.svg#card=math&code=d&id=C9dor">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/e1a71f96c453055c85fac8d8beb42f7c.svg#card=math&code=ed%20%3D%201%20%28mod%20r%29&id=xcisX">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/e7f235b70a634276e7b0f3b30e9f498a.svg#card=math&code=c%20%3D%20n%5Ee%20%28mod%5Chspace%7B1mm%7DN%29&id=sj7Io">
<meta property="og:image" content="https://cdn.nlark.com/yuque/__latex/07c1b16468d0c5f86c83f777d2d07583.svg#card=math&code=n%3D%20c%5Ed%28mod%5Chspace%7B1mm%7DN%29&id=atAy6">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671067662701-1e099f57-99fd-4d8f-9428-2922478f9f70.png#averageHue=%23f1efec&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ud63c1408&margin=%5Bobject%20Object%5D&name=image.png&originHeight=330&originWidth=300&originalType=url&ratio=1&rotation=0&showTitle=false&size=27589&status=done&style=none&taskId=u5a9c4fdf-4b0e-4499-b017-367aecee7d9&title=">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671084532978-588bcda5-139a-4fe6-a6ab-252f329ac589.png#averageHue=%23eef0f2&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=535&id=u1d229842&margin=%5Bobject%20Object%5D&name=image.png&originHeight=669&originWidth=1619&originalType=binary&ratio=1&rotation=0&showTitle=true&size=125879&status=done&style=none&taskId=ube026e88-7802-4112-babf-f24d3d61784&title=SHA%E5%87%BD%E6%95%B0%E5%AF%B9%E6%AF%94&width=1295.2">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671086310369-ad13f05a-8569-4198-a131-0d9a4921db3f.png#averageHue=%23e9ebef&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=175&id=ua5eedd2e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=219&originWidth=826&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26703&status=done&style=none&taskId=u9615d87a-ec84-4440-bba9-70585a55559&title=&width=660.8">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671086340949-4e463d96-04da-4420-a219-230dc1b173f4.png#averageHue=%23e8ebee&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=174&id=uee38495e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=218&originWidth=824&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27073&status=done&style=none&taskId=u519cd460-b208-47b2-afb4-e39b8865009&title=&width=659.2">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671086359133-5d36c421-a096-42c7-bd13-43551199dfb3.png#averageHue=%23b0d7e1&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=175&id=u6c6123df&margin=%5Bobject%20Object%5D&name=image.png&originHeight=219&originWidth=823&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25186&status=done&style=none&taskId=u33404e2d-de2e-4988-af5c-2e66b6c26d4&title=&width=658.4">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671087632654-f65f4023-988b-4b7f-8b6e-5205d3e887c5.png#averageHue=%23fefefe&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=1134&id=u72e45618&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1417&originWidth=1045&originalType=binary&ratio=1&rotation=0&showTitle=false&size=87961&status=done&style=none&taskId=u6f488734-e756-441d-b1e4-ef4fec4a1ab&title=&width=836">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671089725898-9862645c-3301-48bf-9080-6b8e14150298.png#averageHue=%23fefefe&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=802&id=u2e82a641&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1002&originWidth=1069&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63178&status=done&style=none&taskId=u1544ff52-b982-4770-9a9c-33a32800f96&title=&width=855.2">
<meta property="article:published_time" content="2022-12-18T12:02:30.000Z">
<meta property="article:modified_time" content="2024-11-27T09:42:38.464Z">
<meta property="article:author" content="&lt;img src&#x3D;&#39;&#x2F;images&#x2F;iseal1.png&#39; style&#x3D;&#39;display:block;margin:-40px auto;clear:both;&#39;&#x2F;&gt;">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671011360136-0b1e9e27-60b8-4fb4-aca5-0d951d52e493.png#averageHue=%23fdfdfd&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=335&id=u5abe7430&margin=%5Bobject%20Object%5D&name=image.png&originHeight=419&originWidth=374&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13314&status=done&style=none&taskId=ud28bbd74-098d-47aa-891c-72d20712ddf&title=&width=299.2">

<link rel="canonical" href="https://iseal.ac.cn/2022/12/18/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%B8%B8%E8%A7%81%E5%AF%86%E7%A0%81%E7%9A%84%E8%AF%86%E5%88%AB%E2%80%94Sink/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>逆向中的常见密码的识别 | iSEAL</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">iSEAL</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-新闻">

    <a href="/news/" rel="section"><i class="fas fa-bell fa-fw"></i>新闻</a>

  </li>
        <li class="menu-item menu-item-技术">

    <a href="/tech/" rel="section"><i class="fa fa-star fa-fw"></i>技术</a>

  </li>
        <li class="menu-item menu-item-赛事">

    <a href="/matches/" rel="section"><i class="fa fa-user-secret fa-fw"></i>赛事</a>

  </li>
        <li class="menu-item menu-item-投稿">

    <a href="/post" rel="section"><i class="fab fa-stack-overflow fa-fw"></i>投稿</a>

  </li>
        <li class="menu-item menu-item-我们">

    <a href="/about/" rel="section"><i class="fa fa-home fa-fw"></i>我们</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://iseal.ac.cn/2022/12/18/%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%B8%B8%E8%A7%81%E5%AF%86%E7%A0%81%E7%9A%84%E8%AF%86%E5%88%AB%E2%80%94Sink/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="<img src='/images/iseal1.png' style='display:block;margin:-40px auto;clear:both;'/>">
      <meta itemprop="description" content="Information Security Engineering innovAtion Laboratory,<br>Anhui University">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="iSEAL">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          逆向中的常见密码的识别
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-18 20:02:30" itemprop="dateCreated datePublished" datetime="2022-12-18T20:02:30+08:00">2022-12-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-27 17:42:38" itemprop="dateModified" datetime="2024-11-27T17:42:38+08:00">2024-11-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>最近半年打了很多比赛，也见了很多的逆向方向的题目。对于解决对比密文类的逆向题，往往绕不开的一个问题就是对于加密算法的识别。<br>下面就分类对于各种加密的特征以及识别方法进行总结。</p>
<span id="more"></span>

<meta name="referrer" content="no-referrer">



<p><strong>作者：Sink</strong></p>
<h3 id="流密码"><a href="#流密码" class="headerlink" title="流密码"></a>流密码</h3><p>常见的有 <code>RC4</code>、<code>Salsa20</code> 以及 <code>ChaCha20</code>。但是识别出是指定加密是<strong>何种流密码</strong>其实<strong>并不</strong>是非常的<strong>重要</strong>，一般情况下只要识别出来是流密码就可以了，特征就是<strong>密文仅由明文与密钥流经过异或运算得到</strong>。只要识别出流密码，我们就可以选择动态调试获取密钥流或者直接把目标密文 patch 进去拿输出就可以了。</p>
<h4 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*初始化函数*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *s, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">long</span> Len)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> k[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">        k[i] = key[i % Len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        j = (j + s[i] + k[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">// 交换s[i]和s[j]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*加解密*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *s, <span class="type">unsigned</span> <span class="type">char</span> *Data, <span class="type">unsigned</span> <span class="type">long</span> Len)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; Len; k++) &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j]; <span class="comment">// 交换s[x]和s[y]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t = (s[i] + s[j]) % <span class="number">256</span>;</span><br><span class="line">        Data[k] ^= s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>RC4 实现非常简单，特征也非常明显：</p>
<blockquote>
<p>长度为 256 的 S 盒，且在每一步生成与加密过程中都伴随着 S 盒的 swap</p>
</blockquote>
<h4 id="Salsa20"><a href="#Salsa20" class="headerlink" title="Salsa20"></a>Salsa20</h4><p>Salsa20算法通过将 <strong>32 字节（或者 16 字节）的密钥</strong> 和 **8 字节的iv **扩展为伪随机密钥字节流，通过伪随机密钥字节流和异或操作实现加解密。</p>
<h5 id="伪随机密钥字节流的生成"><a href="#伪随机密钥字节流的生成" class="headerlink" title="伪随机密钥字节流的生成"></a>伪随机密钥字节流的生成</h5><p>伪随机密钥字节流的生成其实是使用 密钥、iv、以及一些常量构成 64 字节数据，输入到核心函数中得到 64 字节的输出。<br>Salsa20 密钥拓展规则如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">key 为 32 字节时</span></span><br><span class="line">c[0] + key[0:16] + c[1] + iv + 计数器(8 bytes) + key[16:32] + c[4]</span><br><span class="line">c = [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574] # expand 32-byte k</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">key 为 16 字节时</span></span><br><span class="line">c[0] + key[0:16] + c[1] + iv + 计数器(8 bytes) + key[0:16] + c[4]</span><br><span class="line">c = [0x61707865, 0x3120646e, 0x79622d36, 0x6b206574] # expand 16-byte k</span><br></pre></td></tr></table></figure>
<p>** 核心函数实现： **</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> R(a,b) (((a) <span class="string">&lt;&lt; (b)) | ((a) &gt;</span>&gt; (32 - (b))))</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">salsa20_word_specification</span><span class="params">(uint32 out[<span class="number">16</span>],uint32 in[<span class="number">16</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    uint32 x[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i) x[i] = in[i];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">20</span>; i &gt; <span class="number">0</span>; i -= <span class="number">2</span>) &#123;     <span class="comment">// 迭代次数，注意每次 i -= 2 ！</span></span><br><span class="line">        <span class="comment">// 每列</span></span><br><span class="line">        x[ <span class="number">4</span>] ^= R(x[ <span class="number">0</span>]+x[<span class="number">12</span>], <span class="number">7</span>);  x[ <span class="number">8</span>] ^= R(x[ <span class="number">4</span>]+x[ <span class="number">0</span>], <span class="number">9</span>);</span><br><span class="line">        x[<span class="number">12</span>] ^= R(x[ <span class="number">8</span>]+x[ <span class="number">4</span>],<span class="number">13</span>);  x[ <span class="number">0</span>] ^= R(x[<span class="number">12</span>]+x[ <span class="number">8</span>],<span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        x[ <span class="number">9</span>] ^= R(x[ <span class="number">5</span>]+x[ <span class="number">1</span>], <span class="number">7</span>);  x[<span class="number">13</span>] ^= R(x[ <span class="number">9</span>]+x[ <span class="number">5</span>], <span class="number">9</span>);</span><br><span class="line">        x[ <span class="number">1</span>] ^= R(x[<span class="number">13</span>]+x[ <span class="number">9</span>],<span class="number">13</span>);  x[ <span class="number">5</span>] ^= R(x[ <span class="number">1</span>]+x[<span class="number">13</span>],<span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        x[<span class="number">14</span>] ^= R(x[<span class="number">10</span>]+x[ <span class="number">6</span>], <span class="number">7</span>);  x[ <span class="number">2</span>] ^= R(x[<span class="number">14</span>]+x[<span class="number">10</span>], <span class="number">9</span>);</span><br><span class="line">        x[ <span class="number">6</span>] ^= R(x[ <span class="number">2</span>]+x[<span class="number">14</span>],<span class="number">13</span>);  x[<span class="number">10</span>] ^= R(x[ <span class="number">6</span>]+x[ <span class="number">2</span>],<span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        x[ <span class="number">3</span>] ^= R(x[<span class="number">15</span>]+x[<span class="number">11</span>], <span class="number">7</span>);  x[ <span class="number">7</span>] ^= R(x[ <span class="number">3</span>]+x[<span class="number">15</span>], <span class="number">9</span>);</span><br><span class="line">        x[<span class="number">11</span>] ^= R(x[ <span class="number">7</span>]+x[ <span class="number">3</span>],<span class="number">13</span>);  x[<span class="number">15</span>] ^= R(x[<span class="number">11</span>]+x[ <span class="number">7</span>],<span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 每行</span></span><br><span class="line">        x[ <span class="number">1</span>] ^= R(x[ <span class="number">0</span>]+x[ <span class="number">3</span>], <span class="number">7</span>);  x[ <span class="number">2</span>] ^= R(x[ <span class="number">1</span>]+x[ <span class="number">0</span>], <span class="number">9</span>);</span><br><span class="line">        x[ <span class="number">3</span>] ^= R(x[ <span class="number">2</span>]+x[ <span class="number">1</span>],<span class="number">13</span>);  x[ <span class="number">0</span>] ^= R(x[ <span class="number">3</span>]+x[ <span class="number">2</span>],<span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        x[ <span class="number">6</span>] ^= R(x[ <span class="number">5</span>]+x[ <span class="number">4</span>], <span class="number">7</span>);  x[ <span class="number">7</span>] ^= R(x[ <span class="number">6</span>]+x[ <span class="number">5</span>], <span class="number">9</span>);</span><br><span class="line">        x[ <span class="number">4</span>] ^= R(x[ <span class="number">7</span>]+x[ <span class="number">6</span>],<span class="number">13</span>);  x[ <span class="number">5</span>] ^= R(x[ <span class="number">4</span>]+x[ <span class="number">7</span>],<span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        x[<span class="number">11</span>] ^= R(x[<span class="number">10</span>]+x[ <span class="number">9</span>], <span class="number">7</span>);  x[ <span class="number">8</span>] ^= R(x[<span class="number">11</span>]+x[<span class="number">10</span>], <span class="number">9</span>);</span><br><span class="line">        x[ <span class="number">9</span>] ^= R(x[ <span class="number">8</span>]+x[<span class="number">11</span>],<span class="number">13</span>);  x[<span class="number">10</span>] ^= R(x[ <span class="number">9</span>]+x[ <span class="number">8</span>],<span class="number">18</span>);</span><br><span class="line">        </span><br><span class="line">        x[<span class="number">12</span>] ^= R(x[<span class="number">15</span>]+x[<span class="number">14</span>], <span class="number">7</span>);  x[<span class="number">13</span>] ^= R(x[<span class="number">12</span>]+x[<span class="number">15</span>], <span class="number">9</span>);</span><br><span class="line">        x[<span class="number">14</span>] ^= R(x[<span class="number">13</span>]+x[<span class="number">12</span>],<span class="number">13</span>);  x[<span class="number">15</span>] ^= R(x[<span class="number">14</span>]+x[<span class="number">13</span>],<span class="number">18</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">16</span>;++i) out[i] = x[i] + in[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>后面接着就是 xor 了，看了前面的实现代码，我相信这种加密的识别也并不困难</p>
<blockquote>
<p>首先，构造核心函数输入时的参数，是最容易识别的。（当然也是最容易魔改的）<br>其次，核心函数中的标志性循环左移，以及每一位对应的位移数，不要看着复杂，其实就是 7、9、13、18，可以看到上面的代码中我把每4个分成了一组，因为在实现的时候有时候会把每四个作为一组来处理。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> quarter(a,b,c,d) do &#123;\</span></span><br><span class="line"><span class="meta">	b ^= R(d+a, 7);\</span></span><br><span class="line"><span class="meta">	c ^= R(a+b, 9);\</span></span><br><span class="line"><span class="meta">	d ^= R(b+c, 13);\</span></span><br><span class="line"><span class="meta">	a ^= R(c+d, 18);\</span></span><br><span class="line"><span class="meta">&#125; while (0)</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">salsa20_words</span><span class="params">(<span class="type">uint32_t</span> *out, <span class="type">uint32_t</span> in[<span class="number">16</span>])</span> &#123;</span><br><span class="line">	<span class="type">uint32_t</span> x[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">16</span>; ++i) x[i/<span class="number">4</span>][i%<span class="number">4</span>] = in[i];</span><br><span class="line">	<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">10</span>; ++i) &#123; <span class="comment">// 10 double rounds = 20 rounds</span></span><br><span class="line">		<span class="comment">// column round: quarter round on each column; start at ith element and wrap</span></span><br><span class="line">		quarter(x[<span class="number">0</span>][<span class="number">0</span>], x[<span class="number">1</span>][<span class="number">0</span>], x[<span class="number">2</span>][<span class="number">0</span>], x[<span class="number">3</span>][<span class="number">0</span>]);</span><br><span class="line">		quarter(x[<span class="number">1</span>][<span class="number">1</span>], x[<span class="number">2</span>][<span class="number">1</span>], x[<span class="number">3</span>][<span class="number">1</span>], x[<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">		quarter(x[<span class="number">2</span>][<span class="number">2</span>], x[<span class="number">3</span>][<span class="number">2</span>], x[<span class="number">0</span>][<span class="number">2</span>], x[<span class="number">1</span>][<span class="number">2</span>]);</span><br><span class="line">		quarter(x[<span class="number">3</span>][<span class="number">3</span>], x[<span class="number">0</span>][<span class="number">3</span>], x[<span class="number">1</span>][<span class="number">3</span>], x[<span class="number">2</span>][<span class="number">3</span>]);</span><br><span class="line">		<span class="comment">// row round: quarter round on each row; start at ith element and wrap around</span></span><br><span class="line">		quarter(x[<span class="number">0</span>][<span class="number">0</span>], x[<span class="number">0</span>][<span class="number">1</span>], x[<span class="number">0</span>][<span class="number">2</span>], x[<span class="number">0</span>][<span class="number">3</span>]);</span><br><span class="line">		quarter(x[<span class="number">1</span>][<span class="number">1</span>], x[<span class="number">1</span>][<span class="number">2</span>], x[<span class="number">1</span>][<span class="number">3</span>], x[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">		quarter(x[<span class="number">2</span>][<span class="number">2</span>], x[<span class="number">2</span>][<span class="number">3</span>], x[<span class="number">2</span>][<span class="number">0</span>], x[<span class="number">2</span>][<span class="number">1</span>]);</span><br><span class="line">		quarter(x[<span class="number">3</span>][<span class="number">3</span>], x[<span class="number">3</span>][<span class="number">0</span>], x[<span class="number">3</span>][<span class="number">1</span>], x[<span class="number">3</span>][<span class="number">2</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">16</span>; ++i) out[i] = x[i/<span class="number">4</span>][i%<span class="number">4</span>] + in[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>最后提醒下，Salsa20 核心函数中的 20 轮也是可以魔改的。</p>
</blockquote>
<h4 id="ChaCha20"><a href="#ChaCha20" class="headerlink" title="ChaCha20"></a>ChaCha20</h4><p>ChaCha20 加密基本上和 Salsa20差不多，作者也是同一个人。ChaCha20 的 <strong>密钥为 32 字节</strong>，<strong>iv 为  12 字节</strong>， <strong>计数器为 4 字节</strong></p>
<h5 id="伪随机密钥字节流的生成-1"><a href="#伪随机密钥字节流的生成-1" class="headerlink" title="伪随机密钥字节流的生成"></a>伪随机密钥字节流的生成</h5><p>ChaCha20 密钥拓展规则如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c[0:4] + key[0:32] + 计数器(4 bytes) + iv</span><br><span class="line">c = [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574] # expand 32-byte k</span><br></pre></td></tr></table></figure>
<p><strong>核心函数的实现：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title function_">u32t8le</span><span class="params">(<span class="type">uint32_t</span> v, <span class="type">uint8_t</span> p[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    p[<span class="number">0</span>] = v &amp; <span class="number">0xff</span>;</span><br><span class="line">    p[<span class="number">1</span>] = (v &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">    p[<span class="number">2</span>] = (v &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">    p[<span class="number">3</span>] = (v &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title function_">u8t32le</span><span class="params">(<span class="type">uint8_t</span> p[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> value = p[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    value = (value &lt;&lt; <span class="number">8</span>) | p[<span class="number">2</span>];</span><br><span class="line">    value = (value &lt;&lt; <span class="number">8</span>) | p[<span class="number">1</span>];</span><br><span class="line">    value = (value &lt;&lt; <span class="number">8</span>) | p[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title function_">rotl32</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// http://blog.regehr.org/archives/1063</span></span><br><span class="line">    <span class="keyword">return</span> x &lt;&lt; n | (x &gt;&gt; (-n &amp; <span class="number">31</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://tools.ietf.org/html/rfc7539#section-2.1</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">chacha20_quarterround</span><span class="params">(<span class="type">uint32_t</span> *x, <span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d)</span> &#123;</span><br><span class="line">    x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], <span class="number">16</span>);</span><br><span class="line">    x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c], <span class="number">12</span>);</span><br><span class="line">    x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a],  <span class="number">8</span>);</span><br><span class="line">    x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c],  <span class="number">7</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">chacha20_serialize</span><span class="params">(<span class="type">uint32_t</span> in[<span class="number">16</span>], <span class="type">uint8_t</span> output[<span class="number">64</span>])</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        u32t8le(in[i], output + (i &lt;&lt; <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">chacha20_block</span><span class="params">(<span class="type">uint32_t</span> in[<span class="number">16</span>], <span class="type">uint8_t</span> out[<span class="number">64</span>], <span class="type">int</span> num_rounds)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> x[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(x, in, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>) * <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = num_rounds; i &gt; <span class="number">0</span>; i -= <span class="number">2</span>) &#123;</span><br><span class="line">        chacha20_quarterround(x, <span class="number">0</span>, <span class="number">4</span>,  <span class="number">8</span>, <span class="number">12</span>);</span><br><span class="line">        chacha20_quarterround(x, <span class="number">1</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">13</span>);</span><br><span class="line">        chacha20_quarterround(x, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>);</span><br><span class="line">        chacha20_quarterround(x, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>);</span><br><span class="line">        chacha20_quarterround(x, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>);</span><br><span class="line">        chacha20_quarterround(x, <span class="number">1</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">12</span>);</span><br><span class="line">        chacha20_quarterround(x, <span class="number">2</span>, <span class="number">7</span>,  <span class="number">8</span>, <span class="number">13</span>);</span><br><span class="line">        chacha20_quarterround(x, <span class="number">3</span>, <span class="number">4</span>,  <span class="number">9</span>, <span class="number">14</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        x[i] += in[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    chacha20_serialize(x, out);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>和 Salsa20 整体来说基本一致，识别方法也基本一样，对于二者的区别主要是：</p>
<blockquote>
<p> 密钥拓展规则的不同<br>quarterround 也不同，其中做容易看出来的就是 ChaCha20 的移位为 16 12 8 7，其他的就要看具体的运算逻辑了</p>
</blockquote>
<p>比如最近 RCTF2022 中的checkserver 中的加密，<br>单看密钥 64 字节，没有iv，也没有常量，看起来好像不是 ChaCha20，但是看后面，标志性的循环左移16 12 8 7，我们就可以很容易的识别出来，这是一个去除了密钥拓展的 ChaCha20.<br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671011360136-0b1e9e27-60b8-4fb4-aca5-0d951d52e493.png#averageHue=%23fdfdfd&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=335&id=u5abe7430&margin=%5Bobject%20Object%5D&name=image.png&originHeight=419&originWidth=374&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13314&status=done&style=none&taskId=ud28bbd74-098d-47aa-891c-72d20712ddf&title=&width=299.2" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671011319775-34bc4bca-38fe-44ff-abe7-bcc30cb4ded5.png#averageHue=%23fdfbfb&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=516&id=u6086d67b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=645&originWidth=1209&originalType=binary&ratio=1&rotation=0&showTitle=false&size=70323&status=done&style=none&taskId=ub91f1539-3ba3-42a4-96d4-0c3f537b996&title=&width=967.2" alt="image.png"></p>
<h3 id="分组密码"><a href="#分组密码" class="headerlink" title="分组密码"></a>分组密码</h3><h4 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h4><p>微型加密算法（Tiny Encryption Algorithm，TEA）是一种易于描述和执行的分组密码，密钥长度为128位，分组长度为 64 位，基于 Feistel 结构，流程图如下：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671014351638-0cc8d287-923b-4ebe-991a-680e3687b014.png#averageHue=%23f7f6f6&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u668837ea&margin=%5Bobject%20Object%5D&name=image.png&originHeight=372&originWidth=250&originalType=url&ratio=1&rotation=0&showTitle=false&size=31977&status=done&style=none&taskId=u4c6b5b09-20e3-481d-aa8f-4feb351e0f9&title=" alt="image.png"><br>下面是 TEA 的实现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);  </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;                                   </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出，TEA 的实现确实非常简单，对于TEA的识别，特征常量 <code>delta 0x9e3779b9</code> 是一个非常重要的特征，但是delta在赛题中往往会被魔改为其他数值，这种情况下就需要通过对 Feistel 结构的识别和移位操作的识别来识别了。</p>
<h5 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, delta=<span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], delta=<span class="number">0x9E3779B9</span>, sum=delta*num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>和 TEA 很像，二者区别最简单的方法看 <code>sum += delta</code> 的位置</p>
<h5 id="XXTEA"><a href="#XXTEA" class="headerlink" title="XXTEA"></a>XXTEA</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX ((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4) ^ (sum^y) + (k[p&amp;3^e]^z))</span></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="title function_">btea</span><span class="params">(<span class="type">long</span>* v, <span class="type">long</span> n, <span class="type">long</span>* k)</span> &#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> z=v[n<span class="number">-1</span>], y=v[<span class="number">0</span>], sum=<span class="number">0</span>, e, DELTA=<span class="number">0x9e3779b9</span>;</span><br><span class="line">  <span class="type">long</span> p, q ;</span><br><span class="line">  <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;          <span class="comment">/* Coding Part */</span></span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">    <span class="keyword">while</span> (q-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      sum += DELTA;</span><br><span class="line">      e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++) y = v[p+<span class="number">1</span>], z = v[p] += MX;</span><br><span class="line">      y = v[<span class="number">0</span>];</span><br><span class="line">      z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>) &#123;  <span class="comment">/* Decoding Part */</span></span><br><span class="line">    n = -n;</span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">    sum = q*DELTA ;</span><br><span class="line">    <span class="keyword">while</span> (sum != <span class="number">0</span>) &#123;</span><br><span class="line">      e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--) z = v[p<span class="number">-1</span>], y = v[p] -= MX;</span><br><span class="line">      z = v[n<span class="number">-1</span>];</span><br><span class="line">      y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">      sum -= DELTA;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一般来说，识别可以通过，delta 以及 <code>round = 6 + 52/n</code> 、<code>(sum &gt;&gt; 2) &amp; 3</code>这种特殊的运算来判断。</p>
<h4 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h4><p>详细的实现介绍可以看之前组会分享的 PPT<br><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2022/pdf/21765903/1671015631876-39d61912-f9ac-465e-8027-53af4b08032d.pdf?_lake_card=%7B%22src%22:%22https://www.yuque.com/attachments/yuque/0/2022/pdf/21765903/1671015631876-39d61912-f9ac-465e-8027-53af4b08032d.pdf%22,%22name%22:%22CTF%20DES%E5%8A%A0%E5%AF%86%20.pdf%22,%22size%22:705928,%22type%22:%22application/pdf%22,%22ext%22:%22pdf%22,%22source%22:%22%22,%22status%22:%22done%22,%22mode%22:%22title%22,%22download%22:true,%22taskId%22:%22u18edbeab-e313-4e65-b76b-5a329cba865%22,%22taskType%22:%22upload%22,%22__spacing%22:%22both%22,%22id%22:%22u4c28d8bf%22,%22margin%22:%7B%22top%22:true,%22bottom%22:true%7D,%22card%22:%22file%22%7D">CTF DES加密 .pdf</a></p>
<blockquote>
<p>主要通过 S盒 以及各个置乱表来识别，可以使用插件来自动化识别这些特征。</p>
</blockquote>
<h4 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h4><p>AES（Advanced Encryption Standard，高级加密标准），分组大小是 128 位，根据密钥长度和轮数可以分为 AES-128、AES-192、AES-256，具体区别如下表：</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">AES-128</th>
<th align="center">AES-192</th>
<th align="center">AES-256</th>
</tr>
</thead>
<tbody><tr>
<td align="center">密钥长度（bit）</td>
<td align="center">128</td>
<td align="center">192</td>
<td align="center">256</td>
</tr>
<tr>
<td align="center">轮数</td>
<td align="center">10</td>
<td align="center">12</td>
<td align="center">14</td>
</tr>
</tbody></table>
<h5 id="整体流程"><a href="#整体流程" class="headerlink" title="整体流程"></a>整体流程</h5><p>整体来说AES加密有如下几步</p>
<ol>
<li><p>密钥拓展，使用密钥拓展算法通过初始密钥获取轮密钥</p>
</li>
<li><p>初始轮密钥加</p>
</li>
<li><p>前 9 （或 11，或 13 ） 轮</p>
<ol>
<li>S 盒代换（SubBytes ）</li>
<li>行移位 （ShiftRows ）</li>
<li>列混合 （MixColumns ）</li>
<li>轮密钥加（AddRoundKey）</li>
</ol>
</li>
<li><p>最后一轮</p>
<ol>
<li>S 盒代换（SubBytes ）</li>
<li>行移位 （ShiftRows ）</li>
<li>轮密钥加（AddRoundKey）<h5 id="每个步骤详解"><a href="#每个步骤详解" class="headerlink" title="每个步骤详解"></a>每个步骤详解</h5>下面分别对每个步骤进行介绍</li>
</ol>
</li>
<li><p>SubBytes—通过一个非线性的替换函数，用查找表的方式把每个字节替换成对应的字节。</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671018126611-9c054cb2-6312-440e-9e9b-30409a85568a.png#averageHue=%23b4c294&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u646da090&margin=%5Bobject%20Object%5D&name=image.png&originHeight=166&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=14498&status=done&style=none&taskId=u18942e56-66b5-4b18-9ae2-ddc0aaee76a&title=" alt="image.png"></p>
<ol start="2">
<li>ShiftRows—将矩阵中的每行进行循环移位。<ol>
<li>第 1 行不变，第 2 行循环左移 1， 第 3 行 循环左移 2， 第 4 行循环左移 3</li>
</ol>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671018342661-1cc495b5-1625-4446-b261-da2747cd90c4.png#averageHue=%23617981&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=uc4d60e79&margin=%5Bobject%20Object%5D&name=image.png&originHeight=119&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=14625&status=done&style=none&taskId=u4bb9507d-513b-491e-86f1-6f2b2fbc647&title=" alt="image.png"></p>
<ol start="3">
<li>MixColumns—使用可逆线性转换将状态每一列的四个字节混合在一起，输入输出都是 4 个字节（也就是1列）。<ol>
<li>变换公式如下：</li>
</ol>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671019352528-4aeba7b2-e443-4eb2-8628-6d388c26d2e9.png#averageHue=%23f3f3f3&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=113&id=dV3M5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=141&originWidth=521&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14907&status=done&style=none&taskId=u6373ff85-1178-45bc-a637-9ddfd9825d8&title=&width=416.8" alt="image.png"></p>
<blockquote>
<p>各个值在相加时使用的是模2加法（异或运算)</p>
</blockquote>
<ol start="2">
<li>更一般的，可以认为是把每列看作 <img src="https://cdn.nlark.com/yuque/__latex/71c1775d91d38ee726cc9b43b4cef34f.svg#card=math&code=GF%282%5E8%29&id=dDA8x">上的多项式，让其与一个固定的多项式<img src="https://cdn.nlark.com/yuque/__latex/2769589f342d265753934522b6464d66.svg#card=math&code=03_%7B16%7Dx%5E3%20%2B%2001_%7B16%7Dx%5E2%20%2B%2001_%7B16%7Dx%20%2B%2002_%7B16%7D&id=yljhf">相乘，然后模 <img src="https://cdn.nlark.com/yuque/__latex/1c4ab5dd901f4f11c5c07f67a5faac2c.svg#card=math&code=x%5E4%20%2B%201&id=O0E4u">,通过运算可以证明此运算与上述矩阵运算等价</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671019070773-9bb9630a-f776-4938-b16f-7b0b07d86689.png#averageHue=%23ebc47e&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u3e8df6bf&margin=%5Bobject%20Object%5D&name=image.png&originHeight=170&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=16376&status=done&style=none&taskId=ueb7e0b33-c0dc-44b3-980b-2f1a7cb5d0d&title=" alt="image.png"></p>
<ol start="4">
<li>AddRoundKey—矩阵中的每一个字节都与该轮的轮密钥（round key）做xor运算；每个子密钥由密钥生成方案产生。</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671017800841-6832f751-3a51-4a38-ba83-f4036f3f67c9.png#averageHue=%23deba78&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=BlQ2B&margin=%5Bobject%20Object%5D&name=image.png&originHeight=249&originWidth=320&originalType=url&ratio=1&rotation=0&showTitle=false&size=19903&status=done&style=none&taskId=uc1707850-460a-46b8-9138-55846d8cb51&title=" alt="image.png"></p>
<h5 id="轮密钥生成算法"><a href="#轮密钥生成算法" class="headerlink" title="轮密钥生成算法"></a>轮密钥生成算法</h5><p>每个轮密钥是 128 bit，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint8_t</span> R[] = &#123;<span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">uint8_t</span> * <span class="title function_">Rcon</span><span class="params">(<span class="type">uint8_t</span> i)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">		R[<span class="number">0</span>] = <span class="number">0x01</span>; <span class="comment">// x^(1-1) = x^0 = 1</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &gt; <span class="number">1</span>) &#123;</span><br><span class="line">		R[<span class="number">0</span>] = <span class="number">0x02</span>;</span><br><span class="line">		i--;</span><br><span class="line">		<span class="keyword">while</span> (i &gt; <span class="number">1</span>) &#123;</span><br><span class="line">			R[<span class="number">0</span>] = gmult(R[<span class="number">0</span>], <span class="number">0x02</span>);</span><br><span class="line">			i--;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> R;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">sub_word</span><span class="params">(<span class="type">uint8_t</span> *w)</span> &#123;</span><br><span class="line">	<span class="type">uint8_t</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">		w[i] = s_box[w[i]];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">rot_word</span><span class="params">(<span class="type">uint8_t</span> *w)</span> &#123;</span><br><span class="line">	<span class="type">uint8_t</span> tmp;</span><br><span class="line">	<span class="type">uint8_t</span> i;</span><br><span class="line"></span><br><span class="line">	tmp = w[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">		w[i] = w[i+<span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	w[<span class="number">3</span>] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">coef_add</span><span class="params">(<span class="type">uint8_t</span> a[], <span class="type">uint8_t</span> b[], <span class="type">uint8_t</span> d[])</span> &#123;</span><br><span class="line">	d[<span class="number">0</span>] = a[<span class="number">0</span>]^b[<span class="number">0</span>];</span><br><span class="line">	d[<span class="number">1</span>] = a[<span class="number">1</span>]^b[<span class="number">1</span>];</span><br><span class="line">	d[<span class="number">2</span>] = a[<span class="number">2</span>]^b[<span class="number">2</span>];</span><br><span class="line">	d[<span class="number">3</span>] = a[<span class="number">3</span>]^b[<span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_key_expansion</span><span class="params">(<span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *w)</span> &#123;</span><br><span class="line">	<span class="type">uint8_t</span> tmp[<span class="number">4</span>];</span><br><span class="line">	<span class="type">uint8_t</span> i;</span><br><span class="line">	<span class="type">uint8_t</span> len = Nb*(Nr+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; Nk; i++) &#123;</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">0</span>] = key[<span class="number">4</span>*i+<span class="number">0</span>];</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">1</span>] = key[<span class="number">4</span>*i+<span class="number">1</span>];</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">2</span>] = key[<span class="number">4</span>*i+<span class="number">2</span>];</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">3</span>] = key[<span class="number">4</span>*i+<span class="number">3</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = Nk; i &lt; len; i++) &#123;</span><br><span class="line">		tmp[<span class="number">0</span>] = w[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">0</span>];</span><br><span class="line">		tmp[<span class="number">1</span>] = w[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">1</span>];</span><br><span class="line">		tmp[<span class="number">2</span>] = w[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">2</span>];</span><br><span class="line">		tmp[<span class="number">3</span>] = w[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (i % Nk == <span class="number">0</span>) &#123;</span><br><span class="line">			rot_word(tmp);</span><br><span class="line">			sub_word(tmp);</span><br><span class="line">			coef_add(tmp, Rcon(i / Nk), tmp);</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Nk &gt; <span class="number">6</span> &amp;&amp; i % Nk == <span class="number">4</span>) &#123;</span><br><span class="line">			sub_word(tmp);</span><br><span class="line">		&#125;</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">0</span>] = w[<span class="number">4</span>*(i-Nk)+<span class="number">0</span>]^tmp[<span class="number">0</span>];</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">1</span>] = w[<span class="number">4</span>*(i-Nk)+<span class="number">1</span>]^tmp[<span class="number">1</span>];</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">2</span>] = w[<span class="number">4</span>*(i-Nk)+<span class="number">2</span>]^tmp[<span class="number">2</span>];</span><br><span class="line">		w[<span class="number">4</span>*i+<span class="number">3</span>] = w[<span class="number">4</span>*(i-Nk)+<span class="number">3</span>]^tmp[<span class="number">3</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Rcon 也可以用以下的表格来实现<br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671022609474-87726f66-e8d0-4501-b101-e956eb193cb0.png#averageHue=%23bee5ec&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=82&id=u57ca110d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=102&originWidth=397&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9167&status=done&style=none&taskId=u4de42cd9-e80b-4d40-b19b-4577c63c755&title=&width=317.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671020937494-d43b18f1-1d86-4392-8f3f-6708a9459a65.png#averageHue=%23000000&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=249&id=WqRA5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=996&originWidth=1024&originalType=url&ratio=1&rotation=0&showTitle=false&size=108289&status=done&style=none&taskId=u88aa3d1a-f648-4df1-a330-401d5959252&title=&width=256" alt="image.png"></p>
<h5 id="优化算法"><a href="#优化算法" class="headerlink" title="优化算法"></a>优化算法</h5><p>类似前面介绍的DES加密的SP盒，AES也有着类似的优化算法，除了轮密钥加，以下三个步骤</p>
<ol>
<li>S 盒代换（SubBytes ）</li>
<li>行移位 （ShiftRows ）</li>
<li>列混合 （MixColumns ）</li>
</ol>
<p>可以合并为一步表格置换叫做 Te 表</p>
<h5 id="白盒-AES"><a href="#白盒-AES" class="headerlink" title="白盒 AES"></a>白盒 AES</h5><p>只见过一次，2022年国赛分区赛逆向有个，解法可以参考下面的文章：<br><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-254042.htm">https://bbs.pediy.com/thread-254042.htm</a></p>
<h4 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h4><p>SM4是国密算法，由国家密码局发布，分组长度为128比特，密钥长度为128比特。</p>
<blockquote>
<p>这个加密在22年的比赛中还没遇到过，但是还是简单介绍下</p>
</blockquote>
<h5 id="轮函数"><a href="#轮函数" class="headerlink" title="轮函数"></a>轮函数</h5><p><img src="https://cdn.nlark.com/yuque/__latex/17a8d1cc46fd9320944710021f130f78.svg#card=math&code=X_%7Bi%2B4%7D%20%3D%20X_i%20%5Coplus%20T%28X_%7Bi%2B1%7D%20%5Coplus%20X_%7Bi%2B2%7D%20%5Coplus%20X_%7Bi%2B3%7D%20%5Coplus%20rk_i%29&id=FkS8T"><br><img src="https://cdn.nlark.com/yuque/__latex/98be0941ad80cb7d099eda854884bf2f.svg#card=math&code=T%28X%29%20%3D%20L%28%5Ctau%28X%29%29&id=zCEpB"><br><img src="https://cdn.nlark.com/yuque/__latex/dd7d6991b80636e1d04c98e736373978.svg#card=math&code=%5Ctau%28X%29%20%3D%20%28Sbox%28x_0%29%2C%20Sbox%28x_1%29%2CSbox%28x_2%29%2C%20Sbox%28x_3%29%29&id=TwVRt"><br><img src="https://cdn.nlark.com/yuque/__latex/678f151871d83a46f54ebf90d9370c86.svg#card=math&code=L%28X%29%20%3D%20X%20%5Coplus%20%28X%20%3C%3C%3C%202%29%20%5Coplus%20%28X%20%3C%3C%3C%2010%29%20%5Coplus%20%28X%20%3C%3C%3C%2018%29%20%5Coplus%20%28X%20%3C%3C%3C%2024%29&id=yDtAP"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671027149741-16577499-18d4-4023-a95c-b6c413214abb.png#averageHue=%23f9f9f9&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=593&id=u49e4f38b&margin=%5Bobject%20Object%5D&name=SM4.png&originHeight=741&originWidth=602&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33102&status=done&style=none&taskId=u16f3215b-7b70-45d4-a278-9816080939a&title=&width=481.6" alt="SM4.png"></p>
<h5 id="密钥拓展算法"><a href="#密钥拓展算法" class="headerlink" title="密钥拓展算法"></a>密钥拓展算法</h5><p><img src="https://cdn.nlark.com/yuque/__latex/5b7b1bf1a34efe9e86e4821e5740de9c.svg#card=math&code=MK%20%3D%20%28MK_0%2C%20MK_1%2C%20MK_2%2C%20MK_3%29&id=nJ3K5"><br><img src="https://cdn.nlark.com/yuque/__latex/917e82e80b5360bbf762ce438889e5ba.svg#card=math&code=%28K_0%2C%20K_1%2C%20K_2%2C%20K_3%29%20%3D%20%28MK_0%20%5Coplus%20FK_0%2C%20MK_1%20%5Coplus%20FK_1%2C%20MK_2%20%5Coplus%20FK_2%2CMK_3%20%5Coplus%20FK_3%29&id=FEOVI"><br><img src="https://cdn.nlark.com/yuque/__latex/088fe96dd4ee9f69cbc64cdae91c52b3.svg#card=math&code=K_%7Bi%20%2B%204%7D%20%3D%20K_i%20%5Coplus%20T%27%28K_%7Bi%2B1%7D%20%5Coplus%20K_%7Bi%2B2%7D%5Coplus%20K_%7Bi%2B3%7D%5Coplus%20CK_i%29&id=MJNtJ"><br>T’ 和合成置换T基本类似，只是换了线性置换L为L’<br><img src="https://cdn.nlark.com/yuque/__latex/975e3cea11ce5bf44e5f72890d1e06db.svg#card=math&code=L%27%28X%29%20%3D%20X%20%5Coplus%20%28X%20%3C%3C%3C%2013%29%20%5Coplus%28X%20%3C%3C%3C%2023%29&id=l3qic"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> FK[<span class="number">4</span>] = &#123;<span class="number">0xa3b1bac6</span>, <span class="number">0x56aa3350</span>, <span class="number">0x677d9197</span>, <span class="number">0xb27022dc</span>&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> CK[<span class="number">32</span>] = &#123;</span><br><span class="line">        <span class="number">0x00070E15</span>, <span class="number">0x1C232A31</span>, <span class="number">0x383F464D</span>, <span class="number">0x545B6269</span>,</span><br><span class="line">        <span class="number">0x70777E85</span>, <span class="number">0x8C939AA1</span>, <span class="number">0xA8AFB6BD</span>, <span class="number">0xC4CBD2D9</span>,</span><br><span class="line">        <span class="number">0xE0E7EEF5</span>, <span class="number">0xFC030A11</span>, <span class="number">0x181F262D</span>, <span class="number">0x343B4249</span>,</span><br><span class="line">        <span class="number">0x50575E65</span>, <span class="number">0x6C737A81</span>, <span class="number">0x888F969D</span>, <span class="number">0xA4ABB2B9</span>,</span><br><span class="line">        <span class="number">0xC0C7CED5</span>, <span class="number">0xDCE3EAF1</span>, <span class="number">0xF8FF060D</span>, <span class="number">0x141B2229</span>,</span><br><span class="line">        <span class="number">0x30373E45</span>, <span class="number">0x4C535A61</span>, <span class="number">0x686F767D</span>, <span class="number">0x848B9299</span>,</span><br><span class="line">        <span class="number">0xA0A7AEB5</span>, <span class="number">0xBCC3CAD1</span>, <span class="number">0xD8DFE6ED</span>, <span class="number">0xF4FB0209</span>,</span><br><span class="line">        <span class="number">0x10171E25</span>, <span class="number">0x2C333A41</span>, <span class="number">0x484F565D</span>, <span class="number">0x646B7279</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="识别方法"><a href="#识别方法" class="headerlink" title="识别方法"></a>识别方法</h5><p>由上面的介绍，可以看出，SM4也有着 S盒、FK、CK几个常量表，所以使用插件也可以自动化识别。</p>
<h3 id="非对称密码"><a href="#非对称密码" class="headerlink" title="非对称密码"></a>非对称密码</h3><h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><p>产生公钥和私钥：</p>
<ol>
<li>随机选择两个大素数 <img src="https://cdn.nlark.com/yuque/__latex/d4cd21d60552e207f237e82def9029b6.svg#card=math&code=p&id=YFh2k"> 和 <img src="https://cdn.nlark.com/yuque/__latex/34c7b563b30bde3c748139530686798e.svg#card=math&code=q&id=wXGLc">，且 <img src="https://cdn.nlark.com/yuque/__latex/c7b79e4ca306d5cedc5003c18f8218f7.svg#card=math&code=p%20%5Cneq%20q&id=md6ek"> ，计算 <img src="https://cdn.nlark.com/yuque/__latex/e61b38e90b092dfc845ef584d5ba51a0.svg#card=math&code=N%20%3D%20p%20%2A%20q&id=vw3j7"></li>
<li>求得 <img src="https://cdn.nlark.com/yuque/__latex/a0e97b108ba0aa54041fa4c4957e43e3.svg#card=math&code=r%20%3D%20%5Cvarphi%28p%29%20%5Ctimes%20%5Cvarphi%28q%29%20%3D%20%28p%20-%201%29%20%5Ctimes%20%28q%20-%201%29&id=W6HdC"></li>
<li>选择一个小于<img src="https://cdn.nlark.com/yuque/__latex/72cb3a229067770aeb6caa625a65a1a1.svg#card=math&code=r&id=W9Bj6">的整数<img src="https://cdn.nlark.com/yuque/__latex/c9a277d40d3a0b3afb85cdb557908945.svg#card=math&code=e&id=GCGPF">，使<img src="https://cdn.nlark.com/yuque/__latex/c9a277d40d3a0b3afb85cdb557908945.svg#card=math&code=e&id=QSJkT">与<img src="https://cdn.nlark.com/yuque/__latex/72cb3a229067770aeb6caa625a65a1a1.svg#card=math&code=r&id=ZfeoS">互质。求<img src="https://cdn.nlark.com/yuque/__latex/56c1b0cb7a48ccf9520b0adb3c8cb2e8.svg#card=math&code=d&id=C9dor">，令<img src="https://cdn.nlark.com/yuque/__latex/e1a71f96c453055c85fac8d8beb42f7c.svg#card=math&code=ed%20%3D%201%20%28mod%20r%29&id=xcisX"><blockquote>
<p>(e, N) 是公钥，(d,N) 是私钥</p>
</blockquote>
</li>
</ol>
<h5 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h5><p><img src="https://cdn.nlark.com/yuque/__latex/e7f235b70a634276e7b0f3b30e9f498a.svg#card=math&code=c%20%3D%20n%5Ee%20%28mod%5Chspace%7B1mm%7DN%29&id=sj7Io"></p>
<h5 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h5><p><img src="https://cdn.nlark.com/yuque/__latex/07c1b16468d0c5f86c83f777d2d07583.svg#card=math&code=n%3D%20c%5Ed%28mod%5Chspace%7B1mm%7DN%29&id=atAy6"></p>
<h5 id="识别"><a href="#识别" class="headerlink" title="识别"></a>识别</h5><p>对于<code>RSA</code>的识别，关键是对于大数运算库函数的识别，常见的大数运算库有：<code>GMP</code>、<code>Miracl</code><br>或者一些密码学的库 <code>OpenSSL</code>、<code>Crypto++</code>、<code>libtomcrypt(用的GMP)</code> 也有着对应的实现。</p>
<h3 id="单向散列函数"><a href="#单向散列函数" class="headerlink" title="单向散列函数"></a>单向散列函数</h3><h4 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h4><p>MD5消息摘要算法（MD5，Message-Digest Algorithm），一种被广泛使用的密码散列函数，可以产生出一个128位（16 bytes）的散列值。<br>下面是C语言具体实现：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Constants are the integer part of the sines of integers (in radians) * 2^32.</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> k[<span class="number">64</span>] = &#123;</span><br><span class="line"><span class="number">0xd76aa478</span>, <span class="number">0xe8c7b756</span>, <span class="number">0x242070db</span>, <span class="number">0xc1bdceee</span>,</span><br><span class="line"><span class="number">0xf57c0faf</span>, <span class="number">0x4787c62a</span>, <span class="number">0xa8304613</span>, <span class="number">0xfd469501</span>,</span><br><span class="line"><span class="number">0x698098d8</span>, <span class="number">0x8b44f7af</span>, <span class="number">0xffff5bb1</span>, <span class="number">0x895cd7be</span>,</span><br><span class="line"><span class="number">0x6b901122</span>, <span class="number">0xfd987193</span>, <span class="number">0xa679438e</span>, <span class="number">0x49b40821</span>,</span><br><span class="line"><span class="number">0xf61e2562</span>, <span class="number">0xc040b340</span>, <span class="number">0x265e5a51</span>, <span class="number">0xe9b6c7aa</span>,</span><br><span class="line"><span class="number">0xd62f105d</span>, <span class="number">0x02441453</span>, <span class="number">0xd8a1e681</span>, <span class="number">0xe7d3fbc8</span>,</span><br><span class="line"><span class="number">0x21e1cde6</span>, <span class="number">0xc33707d6</span>, <span class="number">0xf4d50d87</span>, <span class="number">0x455a14ed</span>,</span><br><span class="line"><span class="number">0xa9e3e905</span>, <span class="number">0xfcefa3f8</span>, <span class="number">0x676f02d9</span>, <span class="number">0x8d2a4c8a</span>,</span><br><span class="line"><span class="number">0xfffa3942</span>, <span class="number">0x8771f681</span>, <span class="number">0x6d9d6122</span>, <span class="number">0xfde5380c</span>,</span><br><span class="line"><span class="number">0xa4beea44</span>, <span class="number">0x4bdecfa9</span>, <span class="number">0xf6bb4b60</span>, <span class="number">0xbebfbc70</span>,</span><br><span class="line"><span class="number">0x289b7ec6</span>, <span class="number">0xeaa127fa</span>, <span class="number">0xd4ef3085</span>, <span class="number">0x04881d05</span>,</span><br><span class="line"><span class="number">0xd9d4d039</span>, <span class="number">0xe6db99e5</span>, <span class="number">0x1fa27cf8</span>, <span class="number">0xc4ac5665</span>,</span><br><span class="line"><span class="number">0xf4292244</span>, <span class="number">0x432aff97</span>, <span class="number">0xab9423a7</span>, <span class="number">0xfc93a039</span>,</span><br><span class="line"><span class="number">0x655b59c3</span>, <span class="number">0x8f0ccc92</span>, <span class="number">0xffeff47d</span>, <span class="number">0x85845dd1</span>,</span><br><span class="line"><span class="number">0x6fa87e4f</span>, <span class="number">0xfe2ce6e0</span>, <span class="number">0xa3014314</span>, <span class="number">0x4e0811a1</span>,</span><br><span class="line"><span class="number">0xf7537e82</span>, <span class="number">0xbd3af235</span>, <span class="number">0x2ad7d2bb</span>, <span class="number">0xeb86d391</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// r specifies the per-round shift amounts</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> r[] = &#123;<span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>,</span><br><span class="line">                      <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>,</span><br><span class="line">                      <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>,</span><br><span class="line">                      <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LEFTROTATE(x, c) (((x) <span class="string">&lt;&lt; (c)) | ((x) &gt;</span>&gt; (32 - (c))))</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">to_bytes</span><span class="params">(<span class="type">uint32_t</span> val, <span class="type">uint8_t</span> *bytes)</span></span><br><span class="line">&#123;</span><br><span class="line">    bytes[<span class="number">0</span>] = (<span class="type">uint8_t</span>) val;</span><br><span class="line">    bytes[<span class="number">1</span>] = (<span class="type">uint8_t</span>) (val &gt;&gt; <span class="number">8</span>);</span><br><span class="line">    bytes[<span class="number">2</span>] = (<span class="type">uint8_t</span>) (val &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    bytes[<span class="number">3</span>] = (<span class="type">uint8_t</span>) (val &gt;&gt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">to_int32</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *bytes)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">uint32_t</span>) bytes[<span class="number">0</span>]</span><br><span class="line">        | ((<span class="type">uint32_t</span>) bytes[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>)</span><br><span class="line">        | ((<span class="type">uint32_t</span>) bytes[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>)</span><br><span class="line">        | ((<span class="type">uint32_t</span>) bytes[<span class="number">3</span>] &lt;&lt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">md5</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *initial_msg, <span class="type">size_t</span> initial_len, <span class="type">uint8_t</span> *digest)</span> &#123;</span><br><span class="line">    <span class="comment">// These vars will contain the hash</span></span><br><span class="line">    <span class="type">uint32_t</span> h0, h1, h2, h3;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Message (to prepare)</span></span><br><span class="line">    <span class="type">uint8_t</span> *msg = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> new_len, offset;</span><br><span class="line">    <span class="type">uint32_t</span> w[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint32_t</span> a, b, c, d, i, f, g, temp;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Initialize variables - simple count in nibbles:</span></span><br><span class="line">    h0 = <span class="number">0x67452301</span>;</span><br><span class="line">    h1 = <span class="number">0xefcdab89</span>;</span><br><span class="line">    h2 = <span class="number">0x98badcfe</span>;</span><br><span class="line">    h3 = <span class="number">0x10325476</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//Pre-processing:</span></span><br><span class="line">    <span class="comment">//append &quot;1&quot; bit to message    </span></span><br><span class="line">    <span class="comment">//append &quot;0&quot; bits until message length in bits ≡ 448 (mod 512)</span></span><br><span class="line">    <span class="comment">//append length mod (2^64) to message</span></span><br><span class="line">    <span class="keyword">for</span> (new_len = initial_len + <span class="number">1</span>; new_len % (<span class="number">512</span>/<span class="number">8</span>) != <span class="number">448</span>/<span class="number">8</span>; new_len++);</span><br><span class="line"> </span><br><span class="line">    msg = (<span class="type">uint8_t</span>*)<span class="built_in">malloc</span>(new_len + <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(msg, initial_msg, initial_len);</span><br><span class="line">    msg[initial_len] = <span class="number">0x80</span>; <span class="comment">// append the &quot;1&quot; bit; most significant bit is &quot;first&quot;</span></span><br><span class="line">    <span class="keyword">for</span> (offset = initial_len + <span class="number">1</span>; offset &lt; new_len; offset++)</span><br><span class="line">        msg[offset] = <span class="number">0</span>; <span class="comment">// append &quot;0&quot; bits</span></span><br><span class="line">    <span class="comment">// append the len in bits at the end of the buffer.</span></span><br><span class="line">    to_bytes(initial_len*<span class="number">8</span>, msg + new_len);</span><br><span class="line">    <span class="comment">// initial_len&gt;&gt;29 == initial_len*8&gt;&gt;32, but avoids overflow.</span></span><br><span class="line">    to_bytes(initial_len&gt;&gt;<span class="number">29</span>, msg + new_len + <span class="number">4</span>);</span><br><span class="line">    <span class="comment">// Process the message in successive 512-bit chunks:</span></span><br><span class="line">    <span class="comment">//for each 512-bit chunk of message:</span></span><br><span class="line">    <span class="keyword">for</span>(offset=<span class="number">0</span>; offset&lt;new_len; offset += (<span class="number">512</span>/<span class="number">8</span>)) &#123;</span><br><span class="line">        <span class="comment">// break chunk into sixteen 32-bit words w[j], 0 ≤ j ≤ 15</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">            w[i] = to_int32(msg + offset + i*<span class="number">4</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// Initialize hash value for this chunk:</span></span><br><span class="line">        a = h0;</span><br><span class="line">        b = h1;</span><br><span class="line">        c = h2;</span><br><span class="line">        d = h3;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// Main loop:</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i&lt;<span class="number">64</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; <span class="number">16</span>) &#123;</span><br><span class="line">                f = (b &amp; c) | ((~b) &amp; d); <span class="comment">// F</span></span><br><span class="line">                g = i;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; <span class="number">32</span>) &#123;</span><br><span class="line">                f = (d &amp; b) | ((~d) &amp; c); <span class="comment">// G</span></span><br><span class="line">                g = (<span class="number">5</span>*i + <span class="number">1</span>) % <span class="number">16</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; <span class="number">48</span>) &#123;</span><br><span class="line">                f = b ^ c ^ d; <span class="comment">// H</span></span><br><span class="line">                g = (<span class="number">3</span>*i + <span class="number">5</span>) % <span class="number">16</span>;          </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                f = c ^ (b | (~d)); <span class="comment">// I</span></span><br><span class="line">                g = (<span class="number">7</span>*i) % <span class="number">16</span>;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            temp = d;</span><br><span class="line">            d = c;</span><br><span class="line">            c = b;</span><br><span class="line">            b = b + LEFTROTATE((a + f + k[i] + w[g]), r[i]);</span><br><span class="line">            a = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Add this chunk&#x27;s hash to result so far:</span></span><br><span class="line">        h0 += a;</span><br><span class="line">        h1 += b;</span><br><span class="line">        h2 += c;</span><br><span class="line">        h3 += d;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cleanup</span></span><br><span class="line">    <span class="built_in">free</span>(msg);</span><br><span class="line">    <span class="comment">//var char digest[16] := h0 append h1 append h2 append h3 //(Output is in little-endian)</span></span><br><span class="line">    to_bytes(h0, digest);</span><br><span class="line">    to_bytes(h1, digest + <span class="number">4</span>);</span><br><span class="line">    to_bytes(h2, digest + <span class="number">8</span>);</span><br><span class="line">    to_bytes(h3, digest + <span class="number">12</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671067662701-1e099f57-99fd-4d8f-9428-2922478f9f70.png#averageHue=%23f1efec&clientId=u75a9bdd0-fed7-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ud63c1408&margin=%5Bobject%20Object%5D&name=image.png&originHeight=330&originWidth=300&originalType=url&ratio=1&rotation=0&showTitle=false&size=27589&status=done&style=none&taskId=u5a9c4fdf-4b0e-4499-b017-367aecee7d9&title=" alt="image.png"></p>
<h5 id="识别-1"><a href="#识别-1" class="headerlink" title="识别"></a>识别</h5><p>首先常数 <code>0x67452301</code>, <code>0xefcdab89</code>, <code>0x98badcfe</code>, <code>0x10325476</code>，是识别MD5的一大关键，其次就是 k 和 r 两个表（这俩不一定会写成数组的格式，也有可能硬编码到代码里），一般来说MD5是可以通过插件识别的。</p>
<h4 id="SHA"><a href="#SHA" class="headerlink" title="SHA"></a>SHA</h4><p>安全散列算法（Secure Hash Algorithm，缩写为SHA）是一个密码散列函数家族，是FIPS所认证的安全散列算法。<br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671084532978-588bcda5-139a-4fe6-a6ab-252f329ac589.png#averageHue=%23eef0f2&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=535&id=u1d229842&margin=%5Bobject%20Object%5D&name=image.png&originHeight=669&originWidth=1619&originalType=binary&ratio=1&rotation=0&showTitle=true&size=125879&status=done&style=none&taskId=ube026e88-7802-4112-babf-f24d3d61784&title=SHA%E5%87%BD%E6%95%B0%E5%AF%B9%E6%AF%94&width=1295.2" alt="image.png" title="SHA函数对比"><br>比较常见的有 SHA-1， SHA2-256，SHA2-512，下面是他们的特征：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SHA-1 的初始散列值</span></span><br><span class="line"><span class="type">uint32_t</span> h[<span class="number">5</span>] = &#123;<span class="number">0x67452301</span>, <span class="number">0xEFCDAB89</span>, <span class="number">0x98BADCFE</span>, <span class="number">0x10325476</span>, <span class="number">0xC3D2E1F0</span>&#125;;</span><br><span class="line"><span class="comment">// SHA2-256 的初始散列值</span></span><br><span class="line"><span class="type">uint32_t</span> h[<span class="number">8</span>] = &#123;<span class="number">0x6a09e667</span>, <span class="number">0xbb67ae85</span>, <span class="number">0x3c6ef372</span>, <span class="number">0xa54ff53a</span>, </span><br><span class="line">    <span class="number">0x510e527f</span>, <span class="number">0x9b05688c</span>, <span class="number">0x1f83d9ab</span>, <span class="number">0x5be0cd19</span>&#125;;</span><br><span class="line"><span class="comment">// SHA2-512 的初始散列值</span></span><br><span class="line"><span class="type">uint64_t</span> h[<span class="number">8</span>] = &#123;<span class="number">0x6a09e667f3bcc908</span>, <span class="number">0xbb67ae8584caa73b</span>, </span><br><span class="line">    <span class="number">0x3c6ef372fe94f82b</span>, <span class="number">0xa54ff53a5f1d36f1</span>, </span><br><span class="line">    <span class="number">0x510e527fade682d1</span>, <span class="number">0x9b05688c2b3e6c1f</span>, </span><br><span class="line">    <span class="number">0x1f83d9abfb41bd6b</span>, <span class="number">0x5be0cd19137e2179</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>太多啦，实现细节就不展开了，SHA2中 224和256实现相似，384和512实现相似，但是这四个的初始哈希值都是不一样的，只不过较短的都是截断了最后的 h7</p>
<h5 id="识别-2"><a href="#识别-2" class="headerlink" title="识别"></a>识别</h5><p>与 md5 类似（也是有表的只不过没列出来），就不再赘述了。</p>
<h3 id="BaseXX-系列"><a href="#BaseXX-系列" class="headerlink" title="BaseXX 系列"></a>BaseXX 系列</h3><h4 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h4><p>Base64是网络上最常见的用于传输字节码的编码方式之一，Base64就是一种基于64个可打印字符来表示二进制数据的方法。它的工作方式可以简单的用wiki上的三张图来描述：</p>
<ol>
<li>待加密数据字节数是 3 的整数倍，3 * 8 &#x3D; 4 * 6，即最完美的情况，不需要Padding</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671086310369-ad13f05a-8569-4198-a131-0d9a4921db3f.png#averageHue=%23e9ebef&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=175&id=ua5eedd2e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=219&originWidth=826&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26703&status=done&style=none&taskId=u9615d87a-ec84-4440-bba9-70585a55559&title=&width=660.8" alt="image.png"></p>
<ol start="2">
<li>len % 3 &#x3D; 2，2 * 8 + 2 &#x3D; 3 * 6， 即需要补 2 个 0，此时后面要添加 1 个等号作为标志</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671086340949-4e463d96-04da-4420-a219-230dc1b173f4.png#averageHue=%23e8ebee&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=174&id=uee38495e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=218&originWidth=824&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27073&status=done&style=none&taskId=u519cd460-b208-47b2-afb4-e39b8865009&title=&width=659.2" alt="image.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671086359133-5d36c421-a096-42c7-bd13-43551199dfb3.png#averageHue=%23b0d7e1&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=175&id=u6c6123df&margin=%5Bobject%20Object%5D&name=image.png&originHeight=219&originWidth=823&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25186&status=done&style=none&taskId=u33404e2d-de2e-4988-af5c-2e66b6c26d4&title=&width=658.4" alt="image.png"></p>
<ol start="3">
<li><p>len % 3 &#x3D; 1，1 * 8 + 4 &#x3D; 2 * 6， 即需要补 4 个 0，此时后面要添加 2 个等号作为标志</p>
<h5 id="常见实现"><a href="#常见实现" class="headerlink" title="常见实现"></a>常见实现</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">base64_encode</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *in, <span class="type">unsigned</span> <span class="type">int</span> inlen,</span></span><br><span class="line"><span class="params">                           <span class="type">char</span> *out)</span> &#123;</span><br><span class="line">    <span class="type">int</span> s;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> j;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> c;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> l;</span><br><span class="line">    s = <span class="number">0</span>;</span><br><span class="line">    l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = j = <span class="number">0</span>; i &lt; inlen; i++) &#123;</span><br><span class="line">        c = in[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (s) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            s = <span class="number">1</span>;</span><br><span class="line">            out[j++] = base64en[(c &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            s = <span class="number">2</span>;</span><br><span class="line">            out[j++] = base64en[((l &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>) | ((c &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            s = <span class="number">0</span>;</span><br><span class="line">            out[j++] = base64en[((l &amp; <span class="number">0xF</span>) &lt;&lt; <span class="number">2</span>) | ((c &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3</span>)];</span><br><span class="line">            out[j++] = base64en[c &amp; <span class="number">0x3F</span>];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        l = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">switch</span> (s) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        out[j++] = base64en[(l &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>];</span><br><span class="line">        out[j++] = BASE64_PAD;</span><br><span class="line">        out[j++] = BASE64_PAD;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        out[j++] = base64en[(l &amp; <span class="number">0xF</span>) &lt;&lt; <span class="number">2</span>];</span><br><span class="line">        out[j++] = BASE64_PAD;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    out[j] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">b64_encode</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *src, <span class="type">size_t</span> len)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> *enc = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> buf[<span class="number">4</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// alloc</span></span><br><span class="line">    enc = (<span class="type">char</span> *)b64_buf_malloc();</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == enc) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// parse until end of source</span></span><br><span class="line">    <span class="keyword">while</span> (len--) &#123;</span><br><span class="line">        <span class="comment">// read up to 3 bytes at a time into `tmp&#x27;</span></span><br><span class="line">        tmp[i++] = *(src++);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// if 3 bytes read then encode into `buf&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">3</span> == i) &#123;</span><br><span class="line">            buf[<span class="number">0</span>] = (tmp[<span class="number">0</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">            buf[<span class="number">1</span>] = ((tmp[<span class="number">0</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>) + ((tmp[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">            buf[<span class="number">2</span>] = ((tmp[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>) + ((tmp[<span class="number">2</span>] &amp; <span class="number">0xc0</span>) &gt;&gt; <span class="number">6</span>);</span><br><span class="line">            buf[<span class="number">3</span>] = tmp[<span class="number">2</span>] &amp; <span class="number">0x3f</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// allocate 4 new byts for `enc` and</span></span><br><span class="line">            <span class="comment">// then translate each encoded buffer</span></span><br><span class="line">            <span class="comment">// part by index from the base 64 index table</span></span><br><span class="line">            <span class="comment">// into `enc&#x27; unsigned char array</span></span><br><span class="line">            enc = (<span class="type">char</span> *)b64_buf_realloc(enc, size + <span class="number">4</span>);</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">                enc[size++] = b64_table[buf[i]];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// reset index</span></span><br><span class="line">            i = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// remainder</span></span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// fill `tmp&#x27; with `\0&#x27; at most 3 times</span></span><br><span class="line">        <span class="keyword">for</span> (j = i; j &lt; <span class="number">3</span>; ++j) &#123;</span><br><span class="line">            tmp[j] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// perform same codec as above</span></span><br><span class="line">        buf[<span class="number">0</span>] = (tmp[<span class="number">0</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">        buf[<span class="number">1</span>] = ((tmp[<span class="number">0</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>) + ((tmp[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        buf[<span class="number">2</span>] = ((tmp[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>) + ((tmp[<span class="number">2</span>] &amp; <span class="number">0xc0</span>) &gt;&gt; <span class="number">6</span>);</span><br><span class="line">        buf[<span class="number">3</span>] = tmp[<span class="number">2</span>] &amp; <span class="number">0x3f</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// perform same write to `enc` with new allocation</span></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; (j &lt; i + <span class="number">1</span>); ++j) &#123;</span><br><span class="line">            enc = (<span class="type">char</span> *)b64_buf_realloc(enc, size + <span class="number">1</span>);</span><br><span class="line">            enc[size++] = b64_table[buf[j]];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// while there is still a remainder</span></span><br><span class="line">        <span class="comment">// append `=&#x27; to `enc&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> ((i++ &lt; <span class="number">3</span>)) &#123;</span><br><span class="line">            enc = (<span class="type">char</span> *)b64_buf_realloc(enc, size + <span class="number">1</span>);</span><br><span class="line">            enc[size++] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make sure we have enough space to add &#x27;\0&#x27; character at end.</span></span><br><span class="line">    enc = (<span class="type">char</span> *)b64_buf_realloc(enc, size + <span class="number">1</span>);</span><br><span class="line">    enc[size] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> enc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="识别-3"><a href="#识别-3" class="headerlink" title="识别"></a>识别</h5></li>
<li><p>有 <code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code>码表（或者类似的长度是64就行）</p>
</li>
<li><p>基本上实现就是上面两种形式，对照一下就行</p>
</li>
</ol>
<p>比如下面这个，显然就是上面的第一种形式<br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671087632654-f65f4023-988b-4b7f-8b6e-5205d3e887c5.png#averageHue=%23fefefe&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=1134&id=u72e45618&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1417&originWidth=1045&originalType=binary&ratio=1&rotation=0&showTitle=false&size=87961&status=done&style=none&taskId=u6f488734-e756-441d-b1e4-ef4fec4a1ab&title=&width=836" alt="image.png"></p>
<h4 id="Base32"><a href="#Base32" class="headerlink" title="Base32"></a>Base32</h4><p>就是把 Base64 的 3 * 8 &#x3D; 4 * 6 改成 5 * 8 &#x3D; 8 * 5 而已，不再展开。</p>
<h4 id="Base58"><a href="#Base58" class="headerlink" title="Base58"></a>Base58</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> b58digits_ordered[] = <span class="string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">b58enc</span><span class="params">(<span class="type">char</span> *b58, <span class="type">size_t</span> *b58sz, <span class="type">const</span> <span class="type">void</span> *data, <span class="type">size_t</span> binsz)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">uint8_t</span> *bin = data;</span><br><span class="line">	<span class="type">int</span> carry;</span><br><span class="line">	<span class="type">size_t</span> i, j, high, zcount = <span class="number">0</span>;</span><br><span class="line">	<span class="type">size_t</span> size;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> (zcount &lt; binsz &amp;&amp; !bin[zcount])</span><br><span class="line">		++zcount;</span><br><span class="line">	</span><br><span class="line">	size = (binsz - zcount) * <span class="number">138</span> / <span class="number">100</span> + <span class="number">1</span>;</span><br><span class="line">	<span class="type">uint8_t</span> buf[size];</span><br><span class="line">	<span class="built_in">memset</span>(buf, <span class="number">0</span>, size);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (i = zcount, high = size - <span class="number">1</span>; i &lt; binsz; ++i, high = j)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (carry = bin[i], j = size - <span class="number">1</span>; (j &gt; high) || carry; --j)</span><br><span class="line">		&#123;</span><br><span class="line">			carry += <span class="number">256</span> * buf[j];</span><br><span class="line">			buf[j] = carry % <span class="number">58</span>;</span><br><span class="line">			carry /= <span class="number">58</span>;</span><br><span class="line">			<span class="keyword">if</span> (!j) &#123;</span><br><span class="line">				<span class="comment">// Otherwise j wraps to maxint which is &gt; high</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; size &amp;&amp; !buf[j]; ++j);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (*b58sz &lt;= zcount + size - j)</span><br><span class="line">	&#123;</span><br><span class="line">		*b58sz = zcount + size - j + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (zcount)</span><br><span class="line">		<span class="built_in">memset</span>(b58, <span class="string">&#x27;1&#x27;</span>, zcount);</span><br><span class="line">	<span class="keyword">for</span> (i = zcount; j &lt; size; ++i, ++j)</span><br><span class="line">		b58[i] = b58digits_ordered[buf[j]];</span><br><span class="line">	b58[i] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">	*b58sz = i + <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关键特征为<strong>长度为 58 的码表</strong> ，和 <strong>mod 58</strong> 、 <strong>除以 58</strong> 操作，以及奇怪的 <code>* 138 / 100 + 1</code><br>比如下面这个<br><img src="https://cdn.nlark.com/yuque/0/2022/png/21765903/1671089725898-9862645c-3301-48bf-9080-6b8e14150298.png#averageHue=%23fefefe&clientId=u7ef2ba51-7588-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=802&id=u2e82a641&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1002&originWidth=1069&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63178&status=done&style=none&taskId=u1544ff52-b982-4770-9a9c-33a32800f96&title=&width=855.2" alt="image.png"></p>
<h5 id="Base24"><a href="#Base24" class="headerlink" title="Base24"></a>Base24</h5><p>Base24实现非常简单，简单到没必要了解，因为只需要看一下加密，就能写出来解密。<br>但是还是给一下实现：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> base24code[] = &#123;</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;G&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;V&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;\0&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">char</span> *<span class="title function_">base24encode</span><span class="params">(<span class="type">char</span> *buf, <span class="type">unsigned</span> <span class="type">char</span> *byst, <span class="type">size_t</span> sizeOfBytes)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *p = byst;</span><br><span class="line">    <span class="keyword">while</span> ((<span class="type">size_t</span>)(i = (p-byst)) &lt; sizeOfBytes) &#123;</span><br><span class="line">        buf[<span class="number">2</span>*i] = base24code[((*p) &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">        buf[(<span class="number">2</span>*i)+<span class="number">1</span>] = base24code[<span class="number">23</span> - ((*p) &amp; <span class="number">0x0f</span>)];</span><br><span class="line">        p++;</span><br><span class="line">    &#125;</span><br><span class="line">    buf[(<span class="number">2</span>*i)+<span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/12/18/%E5%9F%BA%E4%BA%8EOpenAI%E7%9A%84Chatbot%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95%E2%80%94Yvling/" rel="prev" title="基于OpenAI的Chatbot开发记录">
      <i class="fa fa-chevron-left"></i> 基于OpenAI的Chatbot开发记录
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/10/28/23%E5%B9%B4%E7%9C%81%E8%B5%9B%E8%8E%B7%E5%A5%96/" rel="next" title="信息安全工程创新实验室学生在2023年全国大学生信息安全竞赛安徽省赛中荣获佳绩">
      信息安全工程创新实验室学生在2023年全国大学生信息安全竞赛安徽省赛中荣获佳绩 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E5%AF%86%E7%A0%81"><span class="nav-number">1.</span> <span class="nav-text">流密码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RC4"><span class="nav-number">1.1.</span> <span class="nav-text">RC4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Salsa20"><span class="nav-number">1.2.</span> <span class="nav-text">Salsa20</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%AA%E9%9A%8F%E6%9C%BA%E5%AF%86%E9%92%A5%E5%AD%97%E8%8A%82%E6%B5%81%E7%9A%84%E7%94%9F%E6%88%90"><span class="nav-number">1.2.1.</span> <span class="nav-text">伪随机密钥字节流的生成</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ChaCha20"><span class="nav-number">1.3.</span> <span class="nav-text">ChaCha20</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%AA%E9%9A%8F%E6%9C%BA%E5%AF%86%E9%92%A5%E5%AD%97%E8%8A%82%E6%B5%81%E7%9A%84%E7%94%9F%E6%88%90-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">伪随机密钥字节流的生成</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81"><span class="nav-number">2.</span> <span class="nav-text">分组密码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TEA"><span class="nav-number">2.1.</span> <span class="nav-text">TEA</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#XTEA"><span class="nav-number">2.1.1.</span> <span class="nav-text">XTEA</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#XXTEA"><span class="nav-number">2.1.2.</span> <span class="nav-text">XXTEA</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DES"><span class="nav-number">2.2.</span> <span class="nav-text">DES</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AES"><span class="nav-number">2.3.</span> <span class="nav-text">AES</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B"><span class="nav-number">2.3.1.</span> <span class="nav-text">整体流程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AF%8F%E4%B8%AA%E6%AD%A5%E9%AA%A4%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.3.2.</span> <span class="nav-text">每个步骤详解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BD%AE%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E7%AE%97%E6%B3%95"><span class="nav-number">2.3.3.</span> <span class="nav-text">轮密钥生成算法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95"><span class="nav-number">2.3.4.</span> <span class="nav-text">优化算法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%99%BD%E7%9B%92-AES"><span class="nav-number">2.3.5.</span> <span class="nav-text">白盒 AES</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SM4"><span class="nav-number">2.4.</span> <span class="nav-text">SM4</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BD%AE%E5%87%BD%E6%95%B0"><span class="nav-number">2.4.1.</span> <span class="nav-text">轮函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E6%8B%93%E5%B1%95%E7%AE%97%E6%B3%95"><span class="nav-number">2.4.2.</span> <span class="nav-text">密钥拓展算法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%86%E5%88%AB%E6%96%B9%E6%B3%95"><span class="nav-number">2.4.3.</span> <span class="nav-text">识别方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81"><span class="nav-number">3.</span> <span class="nav-text">非对称密码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RSA"><span class="nav-number">3.1.</span> <span class="nav-text">RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86"><span class="nav-number">3.1.1.</span> <span class="nav-text">加密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%AF%86"><span class="nav-number">3.1.2.</span> <span class="nav-text">解密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%86%E5%88%AB"><span class="nav-number">3.1.3.</span> <span class="nav-text">识别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%90%91%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text">单向散列函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MD5"><span class="nav-number">4.1.</span> <span class="nav-text">MD5</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%86%E5%88%AB-1"><span class="nav-number">4.1.1.</span> <span class="nav-text">识别</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SHA"><span class="nav-number">4.2.</span> <span class="nav-text">SHA</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%86%E5%88%AB-2"><span class="nav-number">4.2.1.</span> <span class="nav-text">识别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BaseXX-%E7%B3%BB%E5%88%97"><span class="nav-number">5.</span> <span class="nav-text">BaseXX 系列</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Base64"><span class="nav-number">5.1.</span> <span class="nav-text">Base64</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">5.1.1.</span> <span class="nav-text">常见实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%86%E5%88%AB-3"><span class="nav-number">5.1.2.</span> <span class="nav-text">识别</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Base32"><span class="nav-number">5.2.</span> <span class="nav-text">Base32</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Base58"><span class="nav-number">5.3.</span> <span class="nav-text">Base58</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Base24"><span class="nav-number">5.3.1.</span> <span class="nav-text">Base24</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"><img src='/images/iseal1.png' style='display:block;margin:-40px auto;clear:both;'/></p>
  <div class="site-description" itemprop="description">Information Security Engineering innovAtion Laboratory,<br>Anhui University</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ahuseal" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ahuseal" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:admin@iseal.ac.cn" title="E-Mail → mailto:admin@iseal.ac.cn"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Powered by iSEAL</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
